import React, { useState, useEffect } from 'react';
import { 
  Droplets, 
  ShieldCheck, 
  Leaf, 
  PhoneCall, 
  CheckCircle2, 
  ChevronRight, 
  Waves,
  Filter,
  ArrowRight,
  Menu,
  X,
  QrCode,
  Sparkles
} from 'lucide-react';

const App = () => {
  const [isScrolled, setIsScrolled] = useState(false);
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  // 申し込みリンク
  const SIGNUP_LINK = "https://liff.line.me/1656783300-KLG90La1/landing?follow=%40248vmjzs&lp=ksthV0&liff_id=1656783300-KLG90La1";

  // ==============================================
  // ★ 画像の設定エリア (v1.1: CloudFront URL)
  // ==============================================
  const images = {
    // モデルさん（背景透過）
    model: "https://d27rnpuamwvieu.cloudfront.net/0KojVXtPX1AcetyskRPuWzgXX/normal", 
    
    // フィルター画像
    filter: "https://d27rnpuamwvieu.cloudfront.net/0eEiSNJu3uTVWwzfu8JmoHgXX/normal",

    // サーバー画像
    server: "https://d27rnpuamwvieu.cloudfront.net/0X3bkS2LfWZ8U71OIZoZWJQXX/normal",
    
    // お子様の写真（笑顔のおいしさ）
    child: "https://d27rnpuamwvieu.cloudfront.net/0x2X6lRrjjgT9vKSnE95n4gXX/normal",
  };

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const scrollToCta = () => {
    const ctaSection = document.getElementById('cta-section');
    if (ctaSection) {
      ctaSection.scrollIntoView({ behavior: 'smooth' });
    }
    setIsMenuOpen(false);
  };

  return (
    <div className="font-sans text-slate-700 bg-slate-50 min-h-screen selection:bg-cyan-200 selection:text-cyan-900">
      
      {/* Navigation */}
      <nav className={`fixed w-full z-50 transition-all duration-300 ${isScrolled ? 'bg-white/95 shadow-md py-3' : 'bg-transparent py-4'}`}>
        <div className="container mx-auto px-4 md:px-8 flex justify-between items-center">
          <div className="flex items-center gap-2 group cursor-pointer">
            <div className={`p-1 rounded-full ${isScrolled ? 'bg-[#00A0E9] text-white' : 'bg-white text-[#00A0E9]'}`}>
              <Waves className="w-5 h-5" />
            </div>
            <span className={`font-bold text-lg tracking-wider ${isScrolled ? 'text-[#00A0E9]' : 'text-white drop-shadow-md'}`}>
              RakuToku Water
            </span>
          </div>
          
          <div className="hidden md:flex items-center gap-6">
            <a 
              href={SIGNUP_LINK}
              target="_blank"
              rel="noopener noreferrer"
              className={`px-6 py-2 rounded-full text-sm font-bold transition-all duration-300 shadow-lg ${isScrolled ? 'bg-[#00A0E9] text-white hover:bg-[#008CC9]' : 'bg-white text-[#00A0E9] hover:bg-slate-100'}`}
            >
              無料体験に申し込む
            </a>
          </div>

          <button className={`md:hidden ${isScrolled ? 'text-[#00A0E9]' : 'text-white'}`} onClick={() => setIsMenuOpen(!isMenuOpen)}>
            {isMenuOpen ? <X /> : <Menu />}
          </button>
        </div>
      </nav>

      {/* Mobile Menu Overlay */}
      {isMenuOpen && (
        <div className="fixed inset-0 bg-white z-40 flex flex-col items-center justify-center space-y-8 animate-fade-in md:hidden">
          <span className="text-xl font-bold text-slate-800" onClick={scrollToCta}>コンセプト</span>
          <span className="text-xl font-bold text-slate-800" onClick={scrollToCta}>5つのフィルター</span>
          <a 
            href={SIGNUP_LINK}
            target="_blank"
            rel="noopener noreferrer"
            className="bg-[#00A0E9] text-white px-8 py-3 rounded-full text-lg font-bold shadow-lg"
          >
            無料で試す
          </a>
        </div>
      )}

      {/* Hero Section */}
      <header className="relative min-h-[90vh] pt-24 pb-0 overflow-hidden bg-gradient-to-b from-[#40C4FF] to-[#0091EA]">
        {/* Background Pattern */}
        <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/diamond-upholstery.png')]"></div>
        
        {/* ★ z-20 を追加して、コンテンツ全体を最前面に配置 */}
        <div className="container mx-auto px-4 md:px-8 relative z-20 h-full flex flex-col md:flex-row items-center">
          
          {/* Left Side: Copy & Features & Product */}
          <div className="w-full md:w-3/5 text-center md:text-left z-20 pb-12 md:pb-0">
            
            {/* Main Copy (v1時点の状態) */}
            <div className="mb-8 animate-fade-in-up">
              <h1 className="text-4xl md:text-5xl lg:text-6xl font-black text-white leading-tight drop-shadow-md mb-2">
                県外とは水質が違う、<br />
                <span className="inline-block transform hover:scale-105 transition-transform duration-500 text-5xl md:text-7xl">沖縄の水。</span>
              </h1>
              <div className="w-full h-0.5 bg-white/50 my-4 rounded-full"></div>
              <p className="text-white text-lg md:text-2xl font-bold tracking-wide drop-shadow-sm">
                その違いを前提に設計した5段階フィルター。
              </p>
            </div>

            {/* 3 Blue Feature Boxes (Flyer Style) */}
            <div className="flex flex-col gap-3 mb-10 max-w-lg mx-auto md:mx-0">
              <FlyerFeatureBox text="ミネラルを残して 軟水化" />
              <FlyerFeatureBox text="有機フッ素化合物 対策" />
              <FlyerFeatureBox text="活性炭 ダブル構造" />
            </div>

            {/* Product Area: Server & Filters */}
            <div className="flex flex-col sm:flex-row items-end justify-center md:justify-start gap-6 md:gap-8">
               {/* Server Image Area */}
               <div className="relative w-32 md:w-40 flex flex-col items-center">
                 {/* ★ 装飾レイヤーを背面に配置 (absolute z-0) */}
                 <div className="absolute inset-0 bg-white/20 backdrop-blur-sm rounded-2xl shadow-xl border border-white/30 z-0"></div>
                 
                 {/* ★ 画像レイヤーを前面に配置 (relative z-10) */}
                 <div className="relative z-10 w-full p-2 flex flex-col items-center">
                     <SmartImage 
                       src={images.server}
                       fallbackSrc="https://placehold.co/150x300/f8fafc/cbd5e1?text=Server" 
                       alt="ウォーターサーバー"
                       className="w-full h-auto object-contain drop-shadow-lg"
                     />
                     <div className="mt-2 text-white text-[10px] font-bold tracking-widest opacity-80">RakuToku</div>
                 </div>
               </div>

               {/* Filter Image Area */}
               <div className="relative flex-1 max-w-sm">
                 {/* ★ 装飾レイヤーを背面に配置 (absolute z-0) */}
                 <div className="absolute inset-0 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20 shadow-lg z-0"></div>

                 {/* ★ 画像レイヤーを前面に配置 (relative z-10) */}
                 <div className="relative z-10 p-3">
                    <SmartImage 
                      src={images.filter}
                      fallbackSrc="https://placehold.co/400x150/ffffff/00a0e9?text=Filter+Structure"
                      alt="5段階フィルター"
                      className="w-full h-auto object-contain rounded"
                    />
                    <div className="mt-2 text-center">
                      <div className="bg-white text-[#00A0E9] text-xs font-bold py-1 px-4 rounded-full shadow-sm inline-block">
                        沖縄仕様フィルター構成（5段階）
                      </div>
                    </div>
                 </div>
               </div>
            </div>

          </div>

          {/* Right Side: Model Image (v1時点: サイズ通常) */}
          <div className="w-full md:w-2/5 relative flex justify-center md:justify-end mt-8 md:mt-0 h-[400px] md:h-[600px]">
             
             {/* Back Glow (To blend white background image) */}
             <div className="absolute bottom-0 right-0 w-full h-[80%] bg-gradient-to-t from-white/80 via-white/40 to-transparent rounded-t-full filter blur-2xl z-0 md:w-[120%] md:-right-10 opacity-70"></div>

             {/* Text Bubble - Moved to Left Side */}
             <div className="absolute top-0 left-4 md:top-32 md:-left-16 z-30 animate-bounce-slow">
                 <div className="text-white font-bold text-lg md:text-xl drop-shadow-md transform -rotate-12 leading-tight bg-[#00A0E9]/90 backdrop-blur-sm p-4 rounded-full border-2 border-white/50 shadow-lg text-center">
                   ラクトク<br/>だから<br/>なっとく
                 </div>
             </div>

             {/* Model Image Component */}
             <div className="relative w-full h-full flex items-end justify-center md:justify-end z-10">
                <SmartImage 
                  src={images.model} 
                  fallbackSrc="https://placehold.co/400x600/e0f2fe/00a0e9?text=Model+Image"
                  alt="案内スタッフ"
                  className="max-h-[50vh] md:max-h-[85vh] object-contain object-bottom drop-shadow-2xl"
                />
             </div>
          </div>

        </div>
        
        {/* Wave Divider */}
        <div className="absolute bottom-0 left-0 w-full overflow-hidden leading-none z-10">
          <svg className="relative block w-[calc(100%+1.3px)] h-[40px] md:h-[60px]" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
            <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" fill="#F8FAFC"></path>
          </svg>
        </div>
      </header>

      {/* Section 1: Introduction */}
      <section id="concept" className="py-20 bg-slate-50">
        <div className="container mx-auto px-4 max-w-4xl text-center">
          <h2 className="text-3xl md:text-4xl font-bold text-[#008CC9] mb-8">
            沖縄の水は、県外と同じではありません。
          </h2>
          <div className="bg-white p-8 md:p-12 rounded-3xl shadow-xl border-t-4 border-[#00A0E9]">
            <p className="text-lg leading-loose text-slate-700 mb-6">
              沖縄の水は、地質・浄水工程・配管環境などの影響により、県外とは水質の特徴が異なります。
              また、近年では<span className="font-bold text-red-500 bg-red-50 px-2 py-1 rounded">PFAS（有機フッ素化合物）</span>の問題も注目されています。
            </p>
            <p className="font-bold text-xl text-[#008CC9]">
              だからこそ、「全国共通」ではなく、<br className="md:hidden"/>
              「沖縄専用」のフィルターが必要です。
            </p>
          </div>
        </div>
      </section>

      {/* Section 2: 5 Filters Details */}
      <section id="filters" className="py-20 bg-white">
        <div className="container mx-auto px-4">
          <div className="text-center mb-16">
            <span className="bg-[#00A0E9] text-white px-4 py-1 rounded-full text-sm font-bold tracking-widest shadow-md">
              沖縄仕様
            </span>
            <h2 className="text-3xl md:text-4xl font-bold text-slate-800 mt-4">
              段階的に整える、5つの役割。
            </h2>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-5 gap-4 max-w-6xl mx-auto">
            <FilterCard 
              num="01" 
              title="除去" 
              sub="セディメント"
              desc="砂・サビ・微細な不純物を除去し、後段フィルターを守る。" 
              color="border-l-4 border-slate-300"
            />
            <FilterCard 
              num="02" 
              title="吸着" 
              sub="プレカーボン"
              desc="活性炭の力で塩素やニオイを吸着し、飲みやすさを整える。" 
              color="border-l-4 border-slate-400"
            />
            <FilterCard 
              num="03" 
              title="対策" 
              sub="ブロックカーボン"
              desc="PFASなど微細な化学物質へ、二重の活性炭で徹底配慮。" 
              color="border-l-4 border-[#00A0E9] ring-2 ring-[#00A0E9]/20 shadow-lg bg-blue-50/50"
              badge="重要"
            />
            <FilterCard 
              num="04" 
              title="濾過" 
              sub="UFフィルター"
              desc="細菌・ウイルスレベルを除去しつつ、ミネラルは通す。" 
              color="border-l-4 border-cyan-400"
            />
            <FilterCard 
              num="05" 
              title="軟水" 
              sub="ポストカーボン"
              desc="硬度を抑え、赤ちゃんや料理にも最適なまろやかさに。" 
              color="border-l-4 border-pink-300"
            />
          </div>
        </div>
      </section>

      {/* Section 3: Child Photo & Eco/Safety */}
      <section className="py-24 bg-[#E0F7FA] relative overflow-hidden">
        <div className="container mx-auto px-4 relative z-10">
          <div className="flex flex-col md:flex-row items-center gap-12">
            
            <div className="w-full md:w-1/2">
               <div className="relative">
                 {/* Photo Frame Effect */}
                 <div className="absolute top-4 left-4 w-full h-full border-4 border-[#00A0E9]/20 rounded-3xl transform rotate-3"></div>
                 <div className="relative rounded-3xl overflow-hidden shadow-2xl transform -rotate-2 border-4 border-white bg-slate-200 aspect-[4/3]">
                    <SmartImage 
                      src={images.child} 
                      fallbackSrc="https://placehold.co/600x450/e0f7fa/00a0e9?text=Child+Image"
                      alt="水を飲む子供"
                      className="w-full h-full object-cover"
                    />
                 </div>
                 {/* Badge */}
                 <div className="absolute -bottom-6 -right-6 bg-white p-4 rounded-full shadow-lg text-[#00A0E9] font-bold text-center w-32 h-32 flex items-center justify-center flex-col border-4 border-[#E0F7FA]">
                    <span className="text-2xl">笑顔</span>
                    <span className="text-xs">のおいしさ</span>
                 </div>
               </div>
            </div>

            <div className="w-full md:w-1/2 text-left md:pl-10">
              <h2 className="text-3xl font-bold text-[#008CC9] mb-8 flex items-center gap-2">
                <Leaf className="fill-current" />
                おいしいから、飲みたくなる。
              </h2>
              <p className="text-lg text-slate-700 leading-loose mb-8">
                「お水ちょうだい！」<br/>
                そんな声が増えるのが、楽得ウォーターの自慢です。<br/>
                <br/>
                不純物はしっかり取り除きながら、<br/>
                ミネラルは残したまろやかな軟水。<br/>
                お子様の毎日の水分補給も、安心してお任せください。
              </p>
              <div className="flex flex-wrap gap-4">
                <div className="bg-white px-5 py-2 rounded-full text-slate-600 font-bold shadow-sm flex items-center gap-2 text-sm">
                  <CheckCircle2 size={16} className="text-[#00A0E9]" /> 赤ちゃんのミルクに
                </div>
                <div className="bg-white px-5 py-2 rounded-full text-slate-600 font-bold shadow-sm flex items-center gap-2 text-sm">
                  <CheckCircle2 size={16} className="text-[#00A0E9]" /> 毎日のお料理に
                </div>
                <div className="bg-white px-5 py-2 rounded-full text-slate-600 font-bold shadow-sm flex items-center gap-2 text-sm">
                  <CheckCircle2 size={16} className="text-[#00A0E9]" /> ペットボトル削減
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

      {/* Section 4: Trust / Promise */}
      <section className="py-20 bg-white">
        <div className="container mx-auto px-4 max-w-4xl">
          <div className="bg-slate-50 border-2 border-[#00A0E9]/30 rounded-3xl p-8 md:p-12 text-center shadow-lg">
            <h2 className="text-2xl md:text-3xl font-bold text-slate-800 mb-6">
              「忘れて課金」はさせません。
            </h2>
            <p className="text-slate-600 mb-8">
              無料体験終了の<span className="font-bold text-[#00A0E9]">7日前</span>に必ずご連絡します。<br/>
              合わなければ、そのまま終了。費用は一切かかりません。
            </p>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
               <PromiseItem icon={<PhoneCall />} text="終了前に連絡" />
               <PromiseItem icon={<CheckCircle2 />} text="継続の意思確認" />
               <PromiseItem icon={<ShieldCheck />} text="勝手な課金なし" />
            </div>
          </div>
        </div>
      </section>

      {/* CTA Section: Collaboration Banner Style */}
      <section id="cta-section" className="bg-[#1a1a1a] text-white py-16 relative overflow-hidden">
        {/* Background Effects */}
        <div className="absolute inset-0 bg-gradient-to-r from-black via-[#1a1a1a] to-[#262626]"></div>
        <div className="absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-[#00A0E9]/20 to-transparent"></div>
        <div className="absolute -bottom-20 -left-20 w-64 h-64 bg-[#F59E0B]/10 rounded-full blur-3xl"></div>

        <div className="container mx-auto px-4 relative z-10">
          <div className="max-w-5xl mx-auto flex flex-col md:flex-row items-center gap-8 md:gap-12">
            
            {/* Left: Collaboration Info */}
            <div className="flex-1 text-center md:text-left space-y-6">
              <div className="flex items-center justify-center md:justify-start gap-6 mb-4">
                 <div className="w-20 h-20 bg-black border border-slate-700 flex items-center justify-center font-serif font-bold text-2xl shadow-[0_0_15px_rgba(255,255,255,0.2)]">
                    <span className="text-white">琉宮祭</span>
                 </div>
                 <X className="text-slate-500 w-6 h-6" />
                 <div className="flex flex-col items-center">
                    <div className="flex items-center gap-1 font-bold text-[#00A0E9] text-xl">
                      <Waves size={24} /> RAKUTOKU
                    </div>
                    <div className="text-xs tracking-widest text-slate-400">OKINAWA</div>
                 </div>
              </div>
              
              <h2 className="text-2xl md:text-4xl font-bold leading-snug">
                <span className="text-[#F59E0B] drop-shadow-sm">琉宮祭コラボキャンペーン</span><br/>
                LINEから特典をGET
              </h2>
              
              <p className="text-slate-300 text-sm md:text-base leading-relaxed">
                琉宮祭の「祈り」「表現」「平和」の想いに共感し、<br className="hidden md:block"/>
                私たちもこの場に立っています。
              </p>
            </div>

            {/* Right: Action Area */}
            <div className="w-full md:w-auto flex-shrink-0 flex flex-col items-center gap-4">
              
              <a 
                href={SIGNUP_LINK}
                target="_blank"
                rel="noopener noreferrer"
                className="w-full md:w-auto bg-[#F59E0B] hover:bg-[#D97706] text-white font-bold py-4 px-8 rounded-lg shadow-lg flex items-center justify-center gap-2 transition-transform transform hover:scale-105"
              >
                <span>今すぐ無料で申し込む</span>
                <ArrowRight size={20} />
              </a>
            </div>

          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="bg-black text-slate-500 py-8 text-center text-xs">
        <div className="container mx-auto px-4">
          <p>&copy; {new Date().getFullYear()} RakuToku Water. Okinawa Optimized Filtration.</p>
        </div>
      </footer>

      {/* Floating CTA (Mobile Only) */}
      <div className={`fixed bottom-0 left-0 w-full p-4 md:hidden z-50 transition-transform duration-300 ${isScrolled ? 'translate-y-0' : 'translate-y-full'}`}>
        <button 
          onClick={scrollToCta}
          className="w-full bg-gradient-to-r from-[#F59E0B] to-[#D97706] text-white font-bold py-4 rounded-xl shadow-2xl flex items-center justify-center gap-2 border-2 border-white/20"
        >
          特典を受け取る <ChevronRight size={20} />
        </button>
      </div>
    </div>
  );
};

// --- Sub Components ---

const SmartImage = ({ src, fallbackSrc, alt, className }) => {
  const [imgSrc, setImgSrc] = useState(src);

  return (
    <img 
      src={imgSrc} 
      alt={alt} 
      className={className}
      onError={() => setImgSrc(fallbackSrc)}
    />
  );
};

const FlyerFeatureBox = ({ text }) => (
  <div className="bg-[#E0F2FE] border-2 border-white text-[#008CC9] font-bold text-lg md:text-xl py-3 px-6 rounded-xl shadow-lg flex items-center gap-3 transform hover:scale-105 transition-transform text-left">
    <div className="w-2 h-2 bg-[#00A0E9] rounded-full flex-shrink-0"></div>
    {text}
  </div>
);

const FilterCard = ({ num, title, sub, desc, color, badge }) => (
  <div className={`bg-white p-6 rounded-xl shadow-sm hover:shadow-md transition-shadow relative ${color}`}>
    {badge && (
      <span className="absolute top-2 right-2 bg-red-500 text-white text-[10px] px-2 py-0.5 rounded-full font-bold">
        {badge}
      </span>
    )}
    <div className="flex items-end gap-2 mb-2">
      <span className="text-3xl font-bold text-slate-200">{num}</span>
      <span className="text-sm font-bold text-[#00A0E9] uppercase mb-1">{sub}</span>
    </div>
    <h3 className="text-lg font-bold text-slate-800 mb-2">{title}</h3>
    <p className="text-xs text-slate-600 leading-relaxed">{desc}</p>
  </div>
);

const PromiseItem = ({ icon, text }) => (
  <div className="bg-white p-4 rounded-xl flex items-center justify-center gap-3 shadow-sm border border-slate-100">
    <div className="text-[#00A0E9]">{icon}</div>
    <span className="font-bold text-slate-700">{text}</span>
  </div>
);

export default App;